$(function(){$("#tabs").tabs();$("#tabs ul").removeClass("ui-corner-all").addClass("ui-corner-top");$(document).one("click",'a[href="#tabs-frag-2"]',function(){$("#tabs-frag-2").empty().load($("#website_url").val()+"backend/backend_content/loadwidgetmaker/")});$("#btn-submit").click(function(){$("#frm_content").submit()});$("#frm_content").submit(function(){var a={content:$(this).find("#content").val(),containerType:$(this).find("#container_type").val(),containerName:$(this).find("#container_name").val(),
pageId:$(this).find("#page_id").val(),containerId:$(this).find("#container_id").val(),published:$("#published").prop("checked")?1:0,publishOn:$("#datepicker").val()};$.ajax({url:$(this).attr("action"),type:"post",dataType:"json",data:a,beforeSend:showSpinner(),success:function(){localStorage.removeItem(generateStorageKey());top.location.reload()},error:function(a){showMessage(a.responseText,!0)}});return!1});$("#adminselectimgfolder").change(function(){var a=$(this).val();a&&0!=a&&$.ajax({url:$("#website_url").val()+
"backend/backend_content/loadimages",type:"post",dataType:"json",data:{folderName:a},beforeSend:function(){},success:function(a){$("#images_small").find(".images-preview").replaceWith(a.small);$("#images_medium").find(".images-preview").replaceWith(a.medium);$("#images_large").find(".images-preview").replaceWith(a.large);$("#images_original").find(".images-preview").replaceWith(a.original)},error:function(){}})});$(document).on("click","#files",function(){var a=$("#list_files");$.ajax({url:$("#website_url").val()+
"backend/backend_content/loadfiles",type:"post",dataType:"json",data:{folder:$("#adminselectimgfolder").val()},success:function(b){a.html(b.html)},error:function(){a.html("Unable to load files list")}})});$("#widgets").click(function(){var a=$("#widgets_maker");a.html().length||$.ajax({url:$("#website_url").val()+"backend/backend_content/loadwidgetmaker",type:"post",dataType:"json",success:function(b){a.html(b.responseText)},error:function(){a.html('<h4 style="text-align: center;">Unable to load widget maker.</h4>')}})});
$("#toogletinymce").click(function(){$("#tabs").tabs({active:0}).toggleClass("hidden");$("#tabs.grid_8").length?($("#tabs").toggleClass("grid_4 grid_8"),$(".above-editor-links").toggleClass("grid_12 grid_4")):$(".above-editor-links").toggleClass("grid_12 grid_8");tinyMCE.getInstanceById("content")?($(this).text("SHOW EDITOR"),tinyMCE.execCommand("mceRemoveControl",!1,"content")):($(this).text("SHOW HTML"),tinyMCE.execCommand("mceAddControl",!1,"content"))});var b=localStorage.getItem(generateStorageKey());
null!==b&&showConfirm("We have found content that has not been saved! Restore?",function(){$("#content").val(b)},function(){localStorage.removeItem(generateStorageKey())},"success")});function dispatchEditorKeyup(b,a){null===b.keyUpTimer&&(b.keyUpTimer=setTimeout(function(){localStorage.setItem(generateStorageKey(),b.getContent());b.keyUpTimer=null},1E3))}
function insertFileLink(b){$("#content").tinymce().execCommand("mceInsertContent",!1,'<a href="'+$("#website_url").val()+"media/"+$("#adminselectimgfolder").val()+"/"+b+'" title="'+b+'">'+b+"</a>")};
